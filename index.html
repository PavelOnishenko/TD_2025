<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Minimal Tower Defense</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
</head>
<body>
    <div id="startOverlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="startTitle">
        <div class="start-menu">
            <h1 id="startTitle">Minimal Tower Defense</h1>
            <p>Protect the base from incoming waves of enemies.</p>
            <button id="startGame" type="button">Start Game</button>
        </div>
    </div>

    <div id="pauseOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="pauseTitle">
        <div class="pause-menu">
            <h2 id="pauseTitle">Paused</h2>
            <p id="pauseMessage">Take a breather. The battle will wait.</p>
            <button id="resumeGame" type="button">Resume</button>
        </div>
    </div>

    <div id="endOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="endMessage" aria-describedby="endDetail">
        <div id="endMenu" class="start-menu end-menu">
            <h2 id="endMessage">Game Over</h2>
            <p id="endDetail">The base was destroyed. Try again!</p>
            <p id="endScore" class="end-score">Score: 0</p>
            <p id="endBestScore" class="end-best-score">Best: 0</p>
            <button id="endRestart" type="button">Restart</button>
        </div>
    </div>

    <main id="gameContainer">
        <canvas id="game" width="907" height="510"></canvas>
        <section id="hud" aria-label="Game controls and stats">
            <div id="lives" class="lives" aria-label="Lives"></div>
            <div class="hud-live-region" aria-live="polite">
                <div id="energy" class="resource" aria-label="Energy: 20">
                    <span class="resource-value">20</span>
                    <img class="resource-icon" src="assets/energy_sign.png" alt="" aria-hidden="true" />
                </div>
            </div>
            <div id="scorePanel" class="score-panel" aria-live="polite">
                <span id="score" class="score-value">Score: 0</span>
                <span id="bestScore" class="score-best">Best: 0</span>
            </div>
            <div class="wave-controls">
                <div class="hud-live-region" aria-live="polite">
                    <div id="wavePanel">
                        <span id="wave" class="wave-label">Wave: 1/10</span>
                        <span id="wavePhase" class="wave-phase wave-phase--prep">Preparation phase</span>
                        <span id="endlessIndicator" class="wave-endless hidden" aria-hidden="true">Endless Mode</span>
                    </div>
                </div>
                <div class="wave-controls__buttons" role="group" aria-label="Wave actions">
                    <button id="nextWave" type="button" aria-label="Next Wave">
                        <span class="hud-button-icon" aria-hidden="true">
                            <svg class="hud-icon hud-icon--next" viewBox="0 0 24 24" focusable="false">
                                <path d="M5 5v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M9 5l10 7-10 7z" fill="currentColor" />
                            </svg>
                        </span>
                        <span class="hud-button-text">Next Wave</span>
                    </button>
                    <button id="mergeTowers" type="button" disabled aria-label="Merge Towers">
                        <span class="hud-button-icon" aria-hidden="true">
                            <svg class="hud-icon hud-icon--merge" viewBox="0 0 24 24" focusable="false">
                                <path d="M6 8l6 4 6-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M6 16l6-4 6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M12 4v16" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </span>
                        <span class="hud-button-text">Merge Towers</span>
                    </button>
                </div>
            </div>
            <div class="hud-live-region hud-live-region--status" aria-live="polite">
                <span id="status"></span>
            </div>
            <div id="tutorialTip" class="tutorial-tip hidden" aria-live="polite"></div>
            <div class="hud-controls">
                <button id="restart" type="button" aria-label="Restart">
                    <span class="hud-button-icon" aria-hidden="true">
                        <svg class="hud-icon hud-icon--restart" viewBox="0 0 24 24" focusable="false">
                            <path d="M12 4v4h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M20 12a8 8 0 1 1-8-8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </span>
                    <span class="hud-button-text">Restart</span>
                </button>
                <div id="saveControls" class="save-controls save-controls--hidden" role="group" aria-label="Save controls">
                    <button id="saveGame" type="button" aria-label="Save Game">
                        <span class="hud-button-icon" aria-hidden="true">
                            <svg class="hud-icon hud-icon--save" viewBox="0 0 24 24" focusable="false">
                                <path d="M6 19h12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M12 4v9" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M8 10l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M6 5h12v14H6z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                            </svg>
                        </span>
                        <span class="hud-button-text">Save Game</span>
                    </button>
                    <button id="loadGame" type="button" disabled aria-label="Load Game">
                        <span class="hud-button-icon" aria-hidden="true">
                            <svg class="hud-icon hud-icon--load" viewBox="0 0 24 24" focusable="false">
                                <path d="M6 19h12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M12 20V11" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M16 14l-4-4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M6 5h12v14H6z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                            </svg>
                        </span>
                        <span class="hud-button-text">Load Game</span>
                    </button>
                    <button id="deleteSave" type="button" class="save-controls__delete" aria-label="Delete Save">
                        <span class="hud-button-icon" aria-hidden="true">
                            <svg class="hud-icon hud-icon--delete" viewBox="0 0 24 24" focusable="false">
                                <path d="M5 7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M10 11v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M14 11v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M7 7l1-3h8l1 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M7 7h10v12a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                            </svg>
                        </span>
                        <span class="hud-button-text">Delete Save</span>
                    </button>
                </div>
                <div class="audio-pause-controls">
                    <div class="audio-controls" role="group" aria-label="Audio controls">
                        <button id="muteToggle" type="button" aria-pressed="false" aria-label="Mute">
                            <span class="hud-button-icon" aria-hidden="true">
                                <svg class="hud-icon hud-icon--mute" viewBox="0 0 24 24" focusable="false">
                                    <path d="M4 10v4h3l5 4V6l-5 4H4z" stroke="currentColor" stroke-width="2" stroke-linejoin="round" fill="none" />
                                    <path class="mute-wave" d="M16 9a3 3 0 0 1 0 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none" />
                                    <path class="mute-wave" d="M19 7a6 6 0 0 1 0 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none" />
                                    <path class="mute-slash" d="M5 5l14 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </span>
                            <span class="hud-button-text">Mute</span>
                        </button>
                        <button id="musicToggle" type="button" aria-pressed="true" aria-label="Music On">
                            <span class="hud-button-icon" aria-hidden="true">
                                <svg class="hud-icon hud-icon--music" viewBox="0 0 24 24" focusable="false">
                                    <path class="music-note" d="M9 5v11.5a2.5 2.5 0 1 0 1.5 2.3V7.5l9-2v8.5a2.5 2.5 0 1 0 1.5 2.3V4.5l-12 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                                    <path class="music-off" d="M5 5l14 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </span>
                            <span class="hud-button-text">Music On</span>
                        </button>
                    </div>
                    <button id="pause" type="button" aria-pressed="false" aria-label="Pause">
                        <span class="hud-button-icon" aria-hidden="true">
                            <svg class="hud-icon hud-icon--pause" viewBox="0 0 24 24" focusable="false">
                                <g class="pause-icon pause-icon--pause" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                    <path d="M8 5v14" />
                                    <path d="M16 5v14" />
                                </g>
                                <path class="pause-icon pause-icon--play" d="M9 6l10 6-10 6z" fill="currentColor" />
                            </svg>
                        </span>
                        <span class="hud-button-text">Pause</span>
                    </button>
                </div>
            </div>
            <div id="crazyGamesUser" class="user-info hidden" aria-live="polite">
                <img id="crazyGamesUserAvatar" alt="CrazyGames profile picture" />
                <span id="crazyGamesUsername"></span>
            </div>
        </section>
        <div id="diagnosticsOverlay" class="diagnostics diagnostics--hidden" aria-live="polite" aria-atomic="true"></div>
    </main>

    <script type="module" src="js/main.js"></script>
</body>
</html>
